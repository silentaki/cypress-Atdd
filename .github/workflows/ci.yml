name: End-to-end tests
on: push
jobs:
  cypress-run:
    runs-on: ubuntu-22.04
    container:
      image: cypress/browsers:latest
      options: --user 1001
      matrix:
        # run 3 copies of the current job in parallel
        containers: [1, 2, 3]
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      # Install npm dependencies, cache them correctly
      # and run all Cypress tests
      - name: Cypress run
        uses: cypress-io/github-action@v6
        with:
          browser: chrome
          parallel: true
          record: true
      env:
          # pass the Cypress Cloud record key as an environment variable
          CYPRESS_RECORD_KEY: b0e0ef56-b1b8-4d68-9c77-59d797de4d19
          # Recommended: pass the GitHub token lets this action correctly
          # determine the unique run id necessary to re-run the checks
          GITHUB_TOKEN: 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